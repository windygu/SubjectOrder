$(document.body).on("click","a",function(e){var n=e.currentTarget,t=$(e.currentTarget).attr("href"),o=/tetris\/page\/index\/(\d{6})\/?\d*/,i=/(.*page\/)index\/\d{6}\/?/;try{if(o.test(t)){var a=t.match(o)[1],s=GLOBAL_VAR.pageid_map[a]||GLOBAL_VAR.pageIds[0];if(i.test(t)){var c=t.match(i)[1];n.href=c+s+"/"}}}catch(e){}}),function(e){"use strict";function n(){return document.referrer&&document.referrer.indexOf("//nativeapp.toutiao.com")>0||/(News|NewsSocial|Explore|NewsArticle)(\ |\/)(\d.\d.\d)/i.test(window.navigator.userAgent)}function t(){var e,n=/(homepage)(\=)(\d)/g,t=(e=window.location.href.match(n))&&e[0]?e[0].split("="):[];return!(!t[0]||"homepage"!==t[0]||!t[1]||"1"!==t[1])}function o(n){var t,o,a=/^(http|https)(:\/\/)/i;(t=e(n.target)).attr("href")&&a.test(t.prop("href"))&&(n.preventDefault(),o=i+t.prop("href"),window.open(o))}var i="sslocal://webview?url=";n()&&t()&&e(document).on("click","a",o)}(window.$),function(e){function n(n,t){this.tpl=['<div class="tt-brand">','<div class="brandtest"></div>','<div class="text">','<span class="">今日头条建站，免费制作您的移动站点</span>',"</div>","</div>"].join(""),this.$parent=n,this.$el=e(this.tpl),this.$parent.append(this.$el),this.showTime=2e3,this.showGapTime=864e5,this.isVisible()&&(this.init(),this.bindEvent())}n.prototype={init:function(){var e=navigator.userAgent;this.isAndroid=e.indexOf("Android")>-1||e.indexOf("Adr")>-1,this.isiOS=!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)},scrolledValue:function(e){var n=(e=e||document).documentElement,t=e.body;return Math.max(window.pageYOffset||0,n.scrollTop,t.scrollTop)},bindEvent:function(){var n=this,t=(e(window).height(),e(document).height());e(document).on("readystatechange",function(){"complete"===document.readyState&&(t=e(document).height())});var o,i=function(e,n,t){var o,i,a,s,c,r=function(){var l=+new Date-s;l<n&&l>=0?o=setTimeout(r,n-l):(o=null,t||(c=e.apply(a,i),o||(a=i=null)))};return function(){a=this,i=arguments,s=+new Date;var l=t&&!o;return o||(o=setTimeout(r,n)),l&&(c=e.apply(a,i),a=i=null),c}},a=0;this.isAndroid&&e(window).swipeDown(i(function(){var i=(n.scrolledValue()+e(window).height()).toFixed(0),s=+new Date;if(i>=t&&s-a>n.showGapTime){a=+new Date,n.$el.removeClass("showOnce");var c=n.$el.clone(!0);n.$el.before(c),n.$el.remove(),n.$el=c,n.$el.addClass("showOnce"),o&&clearTimeout(o),o=setTimeout(function(){n.$el.hide(),n.$el.removeClass("showOnce"),n.$el.show(),clearTimeout(o)},n.showTime)}},300));this.isiOS&&e(window).on("scroll",i(function(){if(!n.$el.hasClass("showOnce")){var i=(n.scrolledValue()+e(window).height()).toFixed(0),s=+new Date;i>=t&&s-a>n.showGapTime&&(a=+new Date,n.$el.addClass("showOnce"),o=setTimeout(function(){n.$el.hide(),n.$el.removeClass("showOnce"),n.$el.show(),clearTimeout(o)},n.showTime))}},300))},isVisible:function(){var e=navigator.userAgent.match(/RevealType\/Dialog/i),n=navigator.userAgent.match(/(News|NewsSocial|Explore|NewsArticle|NewsInHouse|joke_essay|Joke|Video|VideoInHouse|VideoArticle)(\s|\/)(\d.\d.\d)/i);return!(e||n||function(){var e,n=/(revealType)(\=)(\w+)/g,t=(e=window.location.href.match(n))&&e[0]?e[0].split("="):[];return!(!t[0]||"revealType"!==t[0]||!t[1]||"dialog"!==t[1])}())}},new n(e("body"),{})}(Zepto),function(e,n){var t,o,i,a=void 0===a?{}:a,e=void 0===e?{}:e,s=n.GLOBAL_VAR,c=function(){try{return document.querySelector("title").text}catch(e){return""}},r=function(){try{return document.querySelector("img").src}catch(e){return""}};t=s.shareTitle||c()||"今日头条, 广告落地页",o=s.shareDesc||"你关心的, 才是头条！",i=s.shareThumb||r()||"http://s2.pstatp.com/site/tetris/weixin/toutiao_logo_256.png",Math.random().toString(36).substr(2,15),parseInt((new Date).getTime()/1e3);e.onReady=a.onReady=function(t,o){var i=(o=$.extend({},o,{debug:!1})).nonceStr||"Wm3WZYTPz0wzccnW",a=Date.now(),s=o.appId||"wxe8b89be1715734a6",c=o.debug||!1;$.ajax({type:"GET",dataType:"jsonp",jsonp:"callback",data:{appid:s,noncestr:i,timestamp:a,url:n.location.href},url:"//open.snssdk.com/jssdk_signature/",success:function(n){1==n.code&&e.config({debug:c,appId:s,timestamp:a,nonceStr:i,signature:n.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone"]}),e.ready(function(){t&&t.apply(e,arguments)}),e.error(function(e){}),o.always&&o.always(n)}})},n.onload=function(){e.onReady(function(){e.onMenuShareAppMessage({title:t,desc:o,link:n.location.href.split("#")[0],imgUrl:i,success:function(e){console.log("onMenuShareAppMessage success")},cancel:function(){console.warn("onMenuShareAppMessage cancel")}}),e.onMenuShareTimeline({title:t,desc:o,link:n.location.href.split("#")[0],imgUrl:i,success:function(e){console.log("onMenuShareTimeline success")},cancel:function(){console.warn("onMenuShareTimeline cancle")}}),e.onMenuShareQQ({title:t,desc:o,link:n.location.href.split("#")[0],imgUrl:i,success:function(e){console.log("onMenuShareQQ success")},cancel:function(){console.warn("onMenuShareQQ cancle")}}),e.onMenuShareWeibo({title:t,desc:o,link:n.location.href.split("#")[0],imgUrl:i,success:function(e){console.log("onMenuShareWeibo success")},cancel:function(){console.warn("onMenuShareWeibo cancle")}}),e.onMenuShareQZone({title:t,desc:o,link:n.location.href.split("#")[0],imgUrl:i,success:function(e){console.log("onMenuShareQZone success")},cancel:function(){console.warn("onMenuShareQZone cancle")}})},{debug:!0,appId:"wx24f08dc0856036f5"}),e.error(function(e){console.warn(JSON.stringify(e))})}}(wx,window);
